<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>第一页</title>
    <link rel="stylesheet" href="D:\2345Downloads\flight_quality_control\页面\layui\css\layui.css"/>
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        .header{
            padding:0;
            height: 80px;
            background-color: #00a0e9;
        }
        .titleall{
            height: 30px;
            margin: 0;
        }
        h2{
            color: white;
            text-align: center;
            line-height: 40px;
            font-weight: bold;
            margin: 0;
        }
        h3{
            margin: 0;
            font-weight: bold;
        }
        .fence{
            width: 1000px;
            margin: auto;
            color: white;
            text-align: center;
            display: flex;
            justify-content: space-around;
        }
        .sx{
            width: 2px;
            height: 20px;
            background:white;
        }
        .bigbox{
            height: 630px;
            width: 100%;
            padding-top: 10px;
            background-color:#DCDCDC;
        }
        .bb{
            height: 170px;
            width: 99%;
            margin-left: 0.5%;
            border-radius: 2%;
            background-color: white;
            padding-top: 30px;
        }
        .box{
            text-align: center;
            line-height: 100px;
        }
        .shbian{
            /* text-align: center;
            height: 60px;
            line-height: 60px;
            width: 160px;
            cursor: pointer */
        }/*基本的样式*/
        .active{
            color: white;
            background: #00BFFF;
            box-shadow: 0 0 10 #000000;
            border-radius: 6px;
            border: none;
        }/*一个样式*/
        .boxx{
            height: 390px;
            width: 99%;
            margin-top: 10px;
            padding-top: 20px;
            margin-left: 0.5%;
            border-radius: 2%;
            background-color: white;
        }
    </style>
</head>
<body>
<div class="header">
    <div class="titleall">
        <h2>质量问题原因辅助分析原型系统</h2>
    </div>
    <hr style="color: white;">
    <div class="fence">
        <h3 style="color: #FFDEAD;">质量问题及相关数据</h3>
        <div class="sx"></div>
        <h3 onclick="javascrtpt:jump()">分析框架</h3>
        <div class="sx"></div>
        <h3 onclick="javascrtpt:jump1()">质量问题推测</h3>
    </div>
</div>
<div class="bigbox">
    <div class='bb'>
        <fieldset class="layui-elem-field layui-field-title" style="margin-bottom: 0px;">
            <legend>质量问题及相关数据</legend>
        </fieldset>
        <div class="box">
            <button class="shbian1 layui-btn layui-btn-primary layui-border-blue" style="margin-left: 0px;">质量问题数据</button>
            <button class="shbian2 layui-btn layui-btn-primary layui-border-blue" style="margin-left: 0px;">装备设计数据</button>
            <button class="shbian3 layui-btn layui-btn-primary layui-border-blue" style="margin-left: 0px;">成品件设计数据</button>
            <button class="shbian4 layui-btn layui-btn-primary layui-border-blue" style="margin-left: 0px;">关键件设计数据</button>
            <button class="shbian5 layui-btn layui-btn-primary layui-border-blue" style="margin-left: 0px;">成品件制造数据</button>
            <button class="shbian6 layui-btn layui-btn-primary layui-border-blue" style="margin-left: 0px;">关键件制造数据</button>
            <button class="shbian7 layui-btn layui-btn-primary layui-border-blue" style="margin-left: 0px;">故障件试验数据</button>
            <button class="shbian8 layui-btn layui-btn-primary layui-border-blue" style="margin-left: 0px;">装备部署数据</button>
            <button class="shbian9 layui-btn layui-btn-primary layui-border-blue" style="margin-left: 0px;">装备使用数据</button>
            <input type="file" id="uploadfile"style="display:none" onchange="showfile(this)">
            <button type="button" onclick="F_Open_dialog()" class="layui-btn" id="test3"><i class="layui-icon"></i>上传文件</button>
            <button type="button" class="xq layui-btn layui-btn-normal">详情</button>
        </div>
    </div>

    <div class="boxx">
        <fieldset class="layui-elem-field layui-field-title" style="margin-bottom: 0px;">
            <legend>生成表格</legend>
        </fieldset>
        <hr class="layui-border-blue" style="width: 1220px;margin-left: 20px;">
        <div id="excelFile" style="width: 1100px;height:330px;margin-left: 100px;overflow:scroll;">
        <table class="layui-table" style="width: 1000px;margin-left: 100px;">
            <colgroup>
                <col width="150">
                <col width="150">
                <col width="200">
                <col>
            </colgroup>
            <thead>
            <tr>
                <th>序号</th>
                <th>机型</th>
                <th>装备改型时间</th>
                <th>装备改型措施</th>
                <th>装备制造单位</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>1</td>
                <td>幻影-2000</td>
                <td>2012-12-02</td>
                <td>改型措施</td>
                <td>洛克希德马丁5</td>
            </tr>
            <tr>
                <td>2</td>
                <td>幻影-2001</td>
                <td>2013-10-02</td>
                <td>改型措施</td>
                <td>洛克希德马丁6</td>
            </tr>
            <tr>
                <td>3</td>
                <td>幻影-2002</td>
                <td>2014-01-02</td>
                <td>改型措施</td>
                <td>洛克希德马丁4</td>
            </tr>
            </tbody>
        </table>
        </div>
    </div>
</div>
<script type="text/javascript" src="D:\2345Downloads\flight_quality_control\页面\layui\layui.js"></script>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript" src="D:\2345Downloads\flight_quality_control\页面\js\common.js"></script>
<script type="text/javascript" async="" src="D:\2345Downloads\flight_quality_control\页面\js\ga.js"></script>
<script src="D:\2345Downloads\flight_quality_control\页面\js\shim.js"></script>
<script src="D:\2345Downloads\flight_quality_control\页面\js\xlsx.full.min.js"></script>
<script src="D:\2345Downloads\flight_quality_control\页面\js\jquery.js"></script>
<script type="text/javascript">
    function F_Open_dialog()
    {
        document.getElementById("uploadfile").click();
    }
</script>
<script type="text/javascript">
    var excelFile;
    // 读取文件的内容
    function showfile(obj) {
        if(!obj.files) {
            return;
        }
        var f = obj.files[0];
        var reader = new FileReader();
        reader.readAsBinaryString(f);
        reader.onload = function(e) {
            var data = e.target.result;
            excelFile = XLSX.read(data, {
                type: 'binary'
            });
            var dataTable1 = "";
            //只展示第一个表
            var headers = new Array();
            var str = XLSX.utils.sheet_to_json(excelFile.Sheets[excelFile.SheetNames[0]])
            dataTable1+= '<table class="layui-table"><colgroup><col width="150"><col width="150"><col width="200"><col></colgroup><thead><tr>'
            for(var key in str[0]){
                headers.push(key)  //获取表头
                dataTable1 += "<th>" + key + "</th>"
            }
            if (headers[1]=="质量问题标题"&&headers[2]=="机型"&&headers[3]=="装备制造单位"&&headers[4]=="装备制造批次"&&headers[5]=="装备出厂时间"&&headers[6]=="发生时间"&&headers[7]=="装备使用部队"&&headers[8]=="故障件种类"&&headers[9]=="故障件名称"&&headers[10]=="故障件型号"&&headers[11]=="故障件制造单位"&&headers[12]=="故障件制造批次"&&headers[13]=="故障件出厂时间"&&headers[14]=="故障件使用时长"&&headers[15]=="故障现象"&&headers[16]=="故障模式"&&headers[17]=="发生地理环境"&&headers[18]=="装备是否进行过大修"&&headers[19]=="大修时间"&&headers[20]=="大修厂"&&headers[21]=="大修人员"&&headers[22]=="关键件名称"&&headers[23]=="关键件制造单位"&&headers[24]=="关键件制造批次"&&headers[25]=="关键件出厂时间"){
                new1Data(headers,str);
                print(headers,dataTable1,str);
            }else if(headers[1]=="机型"&&headers[2]=="装备改型时间"&&headers[3]=="装备改型措施"&&headers[4]=="装备制造单位"){
                new2Data(headers,str);
                print(headers,dataTable1,str);
            }else if (headers[1]=="机型"&&headers[2]=="成品件种类"){
                new3Data(headers,str);
                print(headers,dataTable1,str);
            }else if (headers[1]=="机型"&&headers[2]=="成品件名称"&&headers[3]=="成品件型号"&&headers[4]=="关键件名称"){
                new4Data(headers,str);
                print(headers,dataTable1,str);
            }else if (headers[1]=="成品件名称"&&headers[2]=="成品件型号"&&headers[3]=="成品件制造单位"&&headers[4]=="成品件制造批次"&&headers[5]=="成品件制造人员"&&headers[6]=="成品件加工设备"&&headers[7]=="成品件原材料来源"){
                new5Data(headers,str);
                print(headers,dataTable1,str);
            }else if (headers[1]=="成品件名称"&&headers[2]=="关键件名称"&&headers[3]=="关键件制造单位"&&headers[4]=="关键件批次"&&headers[5]=="关键件检测数据"&&headers[6]=="关键件检测人员"&&headers[7]=="关键件检测设备"&&headers[8]=="关键件检测设备上次检测时间"){
                new6Data(headers,str);
                print(headers,dataTable1,str);
            }else if (headers[1]=="机型"&&headers[2]=="成品检名称"&&headers[3]=="试验种类"&&headers[4]=="试验输入"&&headers[5]=="实测种类"&&headers[6]=="实测输入"){
                new7Data(headers,str);
                print(headers,dataTable1,str);
            }else if (headers[1]=="机型"&&headers[2]=="部队"&&headers[3]=="部署时间"&&headers[4]=="部署数量"){
                new8Data(headers,str);
                print(headers,dataTable1,str);
            }else if (headers[1]=="年月"&&headers[2]=="机型"&&headers[3]=="部队"&&headers[4]=="飞行小时"&&headers[5]=="执行任务种类"&&headers[6]=="执行任务次数"){
                new9Data(headers,str);
                print(headers,dataTable1,str);
            }else{
                layui.use(['layer'], function () {
                    layer.msg('文件格式错误！');
                })
            }

        }
    }
</script>
<script type="text/javascript">
    function print(headers,dataTable1,str)
    {
        dataTable1 += "</tr></thead><tbody>";

        for(var i=0;i<str.length;i++){
            dataTable1 += "<tr>"
            var json = str[i]
            for( var j=0;j<headers.length;j++){
                dataTable1 += "<td>" + json[headers[j]] + "</td>";
            }
            dataTable1 += "</tr>";
        }

        dataTable1 += "</tbody></table>"
        document.getElementById("excelFile").innerHTML = dataTable1
    }
</script>
<script>
    function new1Data(headers,str)
    {
        layui.use(['layer', 'form', 'table', 'util', 'admin', 'func', 'HttpRequest'], function () {
            var $ = layui.jquery;
            var layer = layui.layer;
            var form = layui.form;
            var table = layui.table;
            var admin = layui.admin;
            var HttpRequest = layui.HttpRequest;
            var func = layui.func;
            var dataList = []

            var myRequest0 = new HttpRequest("/new1qualityProblemData/getId", 'post', function (data) {
                // 这里写请求成功的回调
                console.log(data)

                for (let i = 0; i < data.data.length; i++) {
                    dataList.push(parseInt(data.data[i].quality_id))
                }

            }, function (data) {
                // 这里写请求失败的回调（一般为http状态码为非200）
            });
            myRequest0.start(true);
            var a1=[]
            for(var a =1;;a++){
                if(dataList.indexOf(a) == -1){
                    a1.push(a)
                }
                if(a1.length==str.length){
                    break;
                }
            }
            for(var ii=0;ii<str.length;ii++){
                var j = str[ii]
                var b = { "qualityId":a1[ii],"title":j[headers[1]],"jx":j[headers[2]],"zbUnit": j[headers[3]], "zbBatch": j[headers[4]], "zbDeliverytime": j[headers[5]], "time": j[headers[6]], "zbTroop": j[headers[7]], "faultypartsType": j[headers[8]], "faultypartsTitle": j[headers[9]], "faultpartsModel": j[headers[10]], "faultpartsUnit": j[headers[11]], "faultpartsBatch": j[headers[12]], "faultpartsDeliverytime": j[headers[13]], "faultpartsUsagetime": j[headers[14]], "faultPhenomenon": j[headers[15]], "failureMode": j[headers[16]], "environment": j[headers[17]], "zbFixed": j[headers[18]], "fixedTime": j[headers[19]], "fixedFactory": j[headers[20]], "fixedPerson": j[headers[21]], "keyName": j[headers[22]], "keyFactory": j[headers[23]], "keyBatch": j[headers[24]], "keyDeliverytime": j[headers[25]]}
                $.ajax({
                    contentType: 'application/json;charset=UTF-8',
                    type: "POST",
                    dataType: "json",
                    url: "/new1qualityProblemData/addData",
                    data: JSON.stringify(b),
                    success: function (data) {
                        // 处理数据，如果返回的数据就是json格式的，直接使用.就可以取得，例如data.msg、data.success.phone等
                    }
                })

            }
            layer.msg('上传成功');
        });
    }
</script>
<script>
    function new2Data(headers,str)
    {
        layui.use(['layer', 'form', 'table', 'util', 'admin', 'func', 'HttpRequest'], function () {
            var $ = layui.jquery;
            var layer = layui.layer;
            var form = layui.form;
            var table = layui.table;
            var admin = layui.admin;
            var HttpRequest = layui.HttpRequest;
            var func = layui.func;
            var dataList = []

            var myRequest0 = new HttpRequest("/new2equipmentDesignData/getId", 'post', function (data) {
                // 这里写请求成功的回调
                console.log(data)

                for (let i = 0; i < data.data.length; i++) {
                    dataList.push(parseInt(data.data[i].design_id))
                }

            }, function (data) {
                // 这里写请求失败的回调（一般为http状态码为非200）
            });
            myRequest0.start(true);
            var a1=[]
            for(var a =1;;a++){
                if(dataList.indexOf(a) == -1){
                    a1.push(a)
                }
                if(a1.length==str.length){
                    break;
                }
            }
            for(var ii=0;ii<str.length;ii++){
                var j = str[ii]
                var b = { "designId":a1[ii],"jx":j[headers[1]],"zbModificationTime": j[headers[2]], "zbModificationMeasures": j[headers[3]], "zbUnit": j[headers[4]]}
                $.ajax({
                    contentType: 'application/json;charset=UTF-8',
                    type: "POST",
                    dataType: "json",
                    url: "/new2equipmentDesignData/addData",
                    data: JSON.stringify(b),
                    success: function (data) {
                        // 处理数据，如果返回的数据就是json格式的，直接使用.就可以取得，例如data.msg、data.success.phone等
                    }
                })

            }
            layer.msg('上传成功');
        });
    }
</script>
<script>
    function new3Data(headers,str)
    {
        layui.use(['layer', 'form', 'table', 'util', 'admin', 'func', 'HttpRequest'], function () {
            var $ = layui.jquery;
            var layer = layui.layer;
            var form = layui.form;
            var table = layui.table;
            var admin = layui.admin;
            var HttpRequest = layui.HttpRequest;
            var func = layui.func;
            var dataList = []

            var myRequest0 = new HttpRequest("/new3finishedProductDesignData/getId", 'post', function (data) {
                // 这里写请求成功的回调
                console.log(data)

                for (let i = 0; i < data.data.length; i++) {
                    dataList.push(parseInt(data.data[i].fin_design_id))
                }

            }, function (data) {
                // 这里写请求失败的回调（一般为http状态码为非200）
            });
            myRequest0.start(true);
            var a1=[]
            for(var a =1;;a++){
                if(dataList.indexOf(a) == -1){
                    a1.push(a)
                }
                if(a1.length==str.length){
                    break;
                }
            }
            for(var ii=0;ii<str.length;ii++){
                var j = str[ii]
                var b = { "finDesignId":a1[ii],"jx":j[headers[1]],"productType":j[headers[2]],"productName": j[headers[3]], "productModel": j[headers[4]], "productFactory": j[headers[5]], "frame": j[headers[6]], "topMidBtm": j[headers[7]], "leftCenterRight": j[headers[8]], "installMethod": j[headers[9]], "antivibration": j[headers[10]], "humidityLimit": j[headers[11]], "temperatureLimit": j[headers[12]], "designStrength": j[headers[13]], "modifyTime": j[headers[14]], "modifyMeasures": j[headers[15]], "similarOtherRelation": j[headers[17]]}
                $.ajax({
                    contentType: 'application/json;charset=UTF-8',
                    type: "POST",
                    dataType: "json",
                    url: "/new3finishedProductDesignData/addData",
                    data: JSON.stringify(b),
                    success: function (data) {
                        // 处理数据，如果返回的数据就是json格式的，直接使用.就可以取得，例如data.msg、data.success.phone等
                    }
                })

            }
            layer.msg('上传成功');
        });
    }
</script>
<script>
    function new4Data(headers,str)
    {
        layui.use(['layer', 'form', 'table', 'util', 'admin', 'func', 'HttpRequest'], function () {
            var $ = layui.jquery;
            var layer = layui.layer;
            var form = layui.form;
            var table = layui.table;
            var admin = layui.admin;
            var HttpRequest = layui.HttpRequest;
            var func = layui.func;
            var dataList = []

            var myRequest0 = new HttpRequest("/new4keypartsDesigndata/getId", 'post', function (data) {
                // 这里写请求成功的回调
                console.log(data)

                for (let i = 0; i < data.data.length; i++) {
                    dataList.push(parseInt(data.data[i].keydesign_id))
                }

            }, function (data) {
                // 这里写请求失败的回调（一般为http状态码为非200）
            });
            myRequest0.start(true);
            var a1=[]
            for(var a =1;;a++){
                if(dataList.indexOf(a) == -1){
                    a1.push(a)
                }
                if(a1.length==str.length){
                    break;
                }
            }
            for(var ii=0;ii<str.length;ii++){
                var j = str[ii]
                var b = { "keydesignId":a1[ii],"jx":j[headers[1]],"faultypartsTitle":j[headers[2]],"faultpartsModel": j[headers[3]], "keyName": j[headers[4]]}
                $.ajax({
                    contentType: 'application/json;charset=UTF-8',
                    type: "POST",
                    dataType: "json",
                    url: "/new4keypartsDesigndata/addData",
                    data: JSON.stringify(b),
                    success: function (data) {
                        // 处理数据，如果返回的数据就是json格式的，直接使用.就可以取得，例如data.msg、data.success.phone等
                    }
                })

            }
            layer.msg('上传成功');
        });
    }
</script>
<script>
    function new5Data(headers,str)
    {
        layui.use(['layer', 'form', 'table', 'util', 'admin', 'func', 'HttpRequest'], function () {
            var $ = layui.jquery;
            var layer = layui.layer;
            var form = layui.form;
            var table = layui.table;
            var admin = layui.admin;
            var HttpRequest = layui.HttpRequest;
            var func = layui.func;
            var dataList = []

            var myRequest0 = new HttpRequest("/new5finishedproductManufacturingdata/getId", 'post', function (data) {
                // 这里写请求成功的回调
                console.log(data)

                for (let i = 0; i < data.data.length; i++) {
                    dataList.push(parseInt(data.data[i].faulty_id))
                }

            }, function (data) {
                // 这里写请求失败的回调（一般为http状态码为非200）
            });
            myRequest0.start(true);
            var a1=[]
            for(var a =1;;a++){
                if(dataList.indexOf(a) == -1){
                    a1.push(a)
                }
                if(a1.length==str.length){
                    break;
                }
            }
            for(var ii=0;ii<str.length;ii++){
                var j = str[ii]
                var b = { "faultyId":a1[ii],"faultypartsTitle":j[headers[1]],"faultpartsModel":j[headers[2]],"faultpartsUnit": j[headers[3]], "faultpartsBatch": j[headers[4]], "faultpartsPerson": j[headers[5]], "faultpartsEquipment": j[headers[6]], "faultpartsMaterialsSource": j[headers[7]]}
                $.ajax({
                    contentType: 'application/json;charset=UTF-8',
                    type: "POST",
                    dataType: "json",
                    url: "/new5finishedproductManufacturingdata/addData",
                    data: JSON.stringify(b),
                    success: function (data) {
                        // 处理数据，如果返回的数据就是json格式的，直接使用.就可以取得，例如data.msg、data.success.phone等
                    }
                })

            }
            layer.msg('上传成功');
        });
    }
</script>
<script>
    function new6Data(headers,str)
    {
        layui.use(['layer', 'form', 'table', 'util', 'admin', 'func', 'HttpRequest'], function () {
            var $ = layui.jquery;
            var layer = layui.layer;
            var form = layui.form;
            var table = layui.table;
            var admin = layui.admin;
            var HttpRequest = layui.HttpRequest;
            var func = layui.func;
            var dataList = []

            var myRequest0 = new HttpRequest("/new6keypartsManufacturingdata/getId", 'post', function (data) {
                // 这里写请求成功的回调
                console.log(data)

                for (let i = 0; i < data.data.length; i++) {
                    dataList.push(parseInt(data.data[i].key_id))
                }

            }, function (data) {
                // 这里写请求失败的回调（一般为http状态码为非200）
            });
            myRequest0.start(true);
            var a1=[]
            for(var a =1;;a++){
                if(dataList.indexOf(a) == -1){
                    a1.push(a)
                }
                if(a1.length==str.length){
                    break;
                }
            }
            for(var ii=0;ii<str.length;ii++){
                var j = str[ii]
                var b = { "keyId":a1[ii],"faultypartsTitle":j[headers[1]],"keyName":j[headers[2]],"keyFactory": j[headers[3]], "keyBatch": j[headers[4]], "keyTestdata": j[headers[5]], "keyTestperson": j[headers[6]], "keyTestequiment": j[headers[7]], "keyTestlasttime": j[headers[8]]}
                $.ajax({
                    contentType: 'application/json;charset=UTF-8',
                    type: "POST",
                    dataType: "json",
                    url: "/new6keypartsManufacturingdata/addData",
                    data: JSON.stringify(b),
                    success: function (data) {
                        // 处理数据，如果返回的数据就是json格式的，直接使用.就可以取得，例如data.msg、data.success.phone等
                    }
                })

            }
            layer.msg('上传成功');
        });
    }
</script>
<script>
    function new7Data(headers,str)
    {
        layui.use(['layer', 'form', 'table', 'util', 'admin', 'func', 'HttpRequest'], function () {
            var $ = layui.jquery;
            var layer = layui.layer;
            var form = layui.form;
            var table = layui.table;
            var admin = layui.admin;
            var HttpRequest = layui.HttpRequest;
            var func = layui.func;
            var dataList = []

            var myRequest0 = new HttpRequest("/new7experimentalDataOfFaultyParts/getId", 'post', function (data) {
                // 这里写请求成功的回调
                console.log(data)

                for (let i = 0; i < data.data.length; i++) {
                    dataList.push(parseInt(data.data[i].Experimental_data_of_faulty_parts_id))
                }

            }, function (data) {
                // 这里写请求失败的回调（一般为http状态码为非200）
            });
            myRequest0.start(true);
            var a1=[]
            for(var a =1;;a++){
                if(dataList.indexOf(a) == -1){
                    a1.push(a)
                }
                if(a1.length==str.length){
                    break;
                }
            }
            for(var ii=0;ii<str.length;ii++){
                var j = str[ii]
                var b = { "experimentalDataOfFaultyPartsId":a1[ii],"jx":j[headers[1]],"equipmentName":j[headers[2]],"experimentType": j[headers[3]], "experimentInput": j[headers[4]], "tsetType": j[headers[5]], "testInput": j[headers[6]]}
                $.ajax({
                    contentType: 'application/json;charset=UTF-8',
                    type: "POST",
                    dataType: "json",
                    url: "/new7experimentalDataOfFaultyParts/addData",
                    data: JSON.stringify(b),
                    success: function (data) {
                        // 处理数据，如果返回的数据就是json格式的，直接使用.就可以取得，例如data.msg、data.success.phone等
                    }
                })

            }
            layer.msg('上传成功');
        });
    }
</script>
<script>
    function new8Data(headers,str)
    {
        layui.use(['layer', 'form', 'table', 'util', 'admin', 'func', 'HttpRequest'], function () {
            var $ = layui.jquery;
            var layer = layui.layer;
            var form = layui.form;
            var table = layui.table;
            var admin = layui.admin;
            var HttpRequest = layui.HttpRequest;
            var func = layui.func;
            var dataList = []

            var myRequest0 = new HttpRequest("/new8equipmentDeploymentData/getId", 'post', function (data) {
                // 这里写请求成功的回调
                console.log(data)

                for (let i = 0; i < data.data.length; i++) {
                    dataList.push(parseInt(data.data[i].Equipment_deployment_data_id))
                }

            }, function (data) {
                // 这里写请求失败的回调（一般为http状态码为非200）
            });
            myRequest0.start(true);
            var a1=[]
            for(var a =1;;a++){
                if(dataList.indexOf(a) == -1){
                    a1.push(a)
                }
                if(a1.length==str.length){
                    break;
                }
            }
            for(var ii=0;ii<str.length;ii++){
                var j = str[ii]
                var b = { "equipmentDeploymentDataId":a1[ii],"jx":j[headers[1]],"troop":j[headers[2]],"deplomentTime": j[headers[3]], "deplomentNumber": j[headers[4]]}
                $.ajax({
                    contentType: 'application/json;charset=UTF-8',
                    type: "POST",
                    dataType: "json",
                    url: "/new8equipmentDeploymentData/addData",
                    data: JSON.stringify(b),
                    success: function (data) {
                        // 处理数据，如果返回的数据就是json格式的，直接使用.就可以取得，例如data.msg、data.success.phone等
                    }
                })

            }
            layer.msg('上传成功');
        });
    }
</script>
<script>
    function new9Data(headers,str)
    {
        layui.use(['layer', 'form', 'table', 'util', 'admin', 'func', 'HttpRequest'], function () {
            var $ = layui.jquery;
            var layer = layui.layer;
            var form = layui.form;
            var table = layui.table;
            var admin = layui.admin;
            var HttpRequest = layui.HttpRequest;
            var func = layui.func;
            var dataList = []

            var myRequest0 = new HttpRequest("/new9zbUseData/getId", 'post', function (data) {
                // 这里写请求成功的回调
                console.log(data)

                for (let i = 0; i < data.data.length; i++) {
                    dataList.push(parseInt(data.data[i].ZB_use_data_id))
                }

            }, function (data) {
                // 这里写请求失败的回调（一般为http状态码为非200）
            });
            myRequest0.start(true);
            var a1=[]
            for(var a =1;;a++){
                if(dataList.indexOf(a) == -1){
                    a1.push(a)
                }
                if(a1.length==str.length){
                    break;
                }
            }
            for(var ii=0;ii<str.length;ii++){
                var j = str[ii]
                var b = { "zbUseDataId":a1[ii],"yearmonth":j[headers[1]],"jx":j[headers[2]],"troop": j[headers[3]], "flyHours": j[headers[4]], "taskType": j[headers[5]], "taskFrequency": j[headers[6]]}
                $.ajax({
                    contentType: 'application/json;charset=UTF-8',
                    type: "POST",
                    dataType: "json",
                    url: "/new9zbUseData/addData",
                    data: JSON.stringify(b),
                    success: function (data) {
                        // 处理数据，如果返回的数据就是json格式的，直接使用.就可以取得，例如data.msg、data.success.phone等
                    }
                })

            }
            layer.msg('上传成功');
        });
    }
</script>
<script type="text/javascript">
    jump = function(){
        window.location.href="second.html";
    };
    function jump1(){
        window.location.href="third.html";
    };
    var shb=$('.shbian1');
    shb.on('click',function(){
        if(shb.hasClass('layui-btn-primary layui-border-blue')){//如果有‘test’的样式，就去除他的样式，添加‘active’的样式
            shb.removeClass('layui-btn-primary layui-border-blue').addClass('active');
        }else if(shb.hasClass('active')){//如果有‘active’的样式，就祛除他的样式，添加‘test’的样式
            shb.removeClass('active').addClass('layui-btn-primary layui-border-blue');
        }

    })
    var xq=$('.xq');
    xq.on('click',function(){
        //页面层
        layer.open({
            type: 1,
            title:'表格详细信息',
            skin: 'layui-layer-rim', //加上边框
            area: ['1000px', '500px'], //宽高
            content: $(".layui-table")
        });
    })

</script>
</body>
</html>
